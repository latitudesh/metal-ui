import{extends as _extends}from"../_virtual/_rollupPluginBabelHelpers.js";import{useRef,useState,useCallback}from"react";import Input from"../Input/index.js";import PropTypes from"prop-types";import{jsx}from"@emotion/react";function Editable({value:t="",onSave:n,title:e,className:r="",...l}){const o=useRef(),u=useRef(),s=useRef(!1),[a,i]=useState(t),p=useCallback(async()=>{var e,r;null!==o&&void 0!==o&&null!=(e=o.current)&&null!=(e=e.validity)&&e.valid?(s.current=!1,a!==t&&(null!==u&&void 0!==u&&null!=(e=u.current)&&e.focus(),await(null==n?void 0:n(a))||i(t))):null!==o&&void 0!==o&&null!=(e=o.current)&&null!=(r=e.reportValidity)&&r.call(e)},[n,a,t,null===o||void 0===o?void 0:o.current]);return jsx("div",{className:"focus:outline-none border border-transparent rounded focus:border-border "+r,tabIndex:0,ref:u,onKeyDown:e=>{"Enter"===e.key&&null!==o&&void 0!==o&&null!=(e=o.current)&&e.focus()}},jsx(Input,_extends({},l,{variant:"text-editable",tabIndex:-1,style:{maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},title:e,ref:o,type:"text",value:a,onBlur:()=>{s.current&&p()},onFocus:()=>{s.current=!0},onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key&&p(),"Escape"===e.key&&(i(t),s.current=!1,null!==u&&void 0!==u&&null!=(e=u.current)&&e.focus())},onChange:i})))}Editable.propTypes={value:PropTypes.string,onSave:PropTypes.func,title:PropTypes.string,className:PropTypes.string};export{Editable as default};
